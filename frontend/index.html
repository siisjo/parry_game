<!doctype html>
<html lang="ko">
  <head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-9L0JDLBFGF"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      /**
       * 세션 ID를 가져오거나 없으면 새로 생성하는 함수
       * logger.ts와 동일한 로직을 index.html에 배치하여 첫 이벤트부터 ID를 보장합니다.
       */
      function getOrInitSessionId() {
        const SESSION_KEY = 'game_persistent_session_id';
        const EXPIRY_KEY = 'game_session_expiry';
        const THIRTY_DAYS_MS = 30 * 24 * 60 * 60 * 1000;
        const now = new Date().getTime();

        let sid = localStorage.getItem(SESSION_KEY);
        let expiry = localStorage.getItem(EXPIRY_KEY);

        // ID가 없거나 만료되었다면 새로 생성
        if (!sid || !expiry || now > parseInt(expiry)) {
          sid = crypto.randomUUID();
          localStorage.setItem(SESSION_KEY, sid);
          localStorage.setItem(EXPIRY_KEY, (now + THIRTY_DAYS_MS).toString());
        }
        return sid;
      }

      // 1. 즉시 ID 획득 (최초 방문자도 여기서 UUID가 생성됨)
      const sessionId = getOrInitSessionId();

      // 2. 모든 GA4 이벤트에 공통 파라미터로 주입 (강력 권장)
      gtag('set', {
        'game_session_id': sessionId,
        'user_id': sessionId
      });

      // 3. GA4 기본 설정 및 페이지뷰 전송
      gtag('config', 'G-9L0JDLBFGF', {
        'game_session_id': sessionId, 
        'user_id': sessionId,
        'send_page_view': true 
      });
    </script>

    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <title>Parry Game - 패링게임 | 당신의 반응속도 한계는 어디까지?</title>
    
    <meta property="og:title" content="Parry Game" />
    <meta name="description" content="패링게임으로 당신의 반응속도를 테스트해보세요. 정확한 타이밍의 패링으로 실력을 겨루는 반응속도 테스트 웹게임입니다." />
    <meta property="og:description" content="쏟아지는 공격을 패링하세요! 극한의 반응속도 테스트" />
    <meta property="og:image" content="/share_thumbnail.png" /> 
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>